{% extends 'base.html' %}

{% block content %}
  <head>
    <title>Results</title>
  </head>
  <body>
    <h1>Results</h1>
      <p>You searched for the location of <u>{{ city }}</u> and events <u>{{ interest }}</u>.</p>
      
    <div id="my-plan-empty-message" style="display: none;">Your plan is currently empty.</div>
      
    <div id="my-plan">
      <h2>Your Current Plan:</h2>
    </div>
      
    <button onclick="savePlan()">Save Plan</button>

    <hr>

    <div class="card-container">
      {% for row in range(table.shape[0]) %}
        <div class="card">
            
          <div class="card-header">
            <h2>{{ table['name'][row] }} <button class = "button" onclick="saveToMyPlan('{{ table['name'][row]|escape }}')">+</button></h2>
          </div>
            
          <div class="card-body">
            <p>{{ table['address'][row] }}</p>
            <p>Latitude: {{ table['latitude'][row] }}, Longitude: {{ table['longitude'][row] }}</p>
            <p>Rating: {{ table['rating'][row] }} ({{ table['rating_numbers'][row] }} reviews)</p>
            <p>Opening Hours:</p>
            <ul>
            {% if table['open_hour'][row] != 'No opening hours found.' %}
                {% for hour in table['open_hour'][row] %}
                    <li>{{ hour }}</li>
                {% endfor %}
            {% else %}
                <p> No opening hours found.</p>
            {% endif %}
            </ul>
          </div>
            
        </div>
      {% endfor %}
       
    </div>
    
    <script>
      function saveToMyPlan(name) {
        var myPlanDiv = document.getElementById("my-plan");
        var nameParagraph = document.createElement("p");
        var nameNode = document.createTextNode(name);
        var removeButton = document.createElement("button");
        var buttonText = document.createTextNode("-");
        removeButton.appendChild(buttonText);
        removeButton.id = name; 
        removeButton.onclick = function() {
          myPlanDiv.removeChild(nameParagraph);
          if (myPlanDiv.children.length === 0) {
              document.getElementById("my-plan-empty-message").style.display = "block";
          }
          alert(name + " has been removed from your plan!");
        }
          
        nameParagraph.appendChild(nameNode);
        nameParagraph.appendChild(removeButton);
        myPlanDiv.appendChild(nameParagraph);

        document.getElementById("my-plan-empty-message").style.display = "none";
        alert(name + " has been added to your plan!");

      }
        
      function savePlan() {
        var planItems = [];
        var planDiv = document.getElementById("my-plan");
        for (var i = 0; i < planDiv.children.length; i++) {
          planItems.push(planDiv.children[i].textContent);
        }
        
        // Not Done yet
      }
        
    </script>


{% endblock %}
